# Starship prompt configuration
# Requires a Nerd Font for glyphs

add_newline = true
continuation_prompt = " "

format = """
$os\
$directory$git_branch$git_state$git_status\
$aws$python$nodejs$terraform$package
$line_break$character
"""

right_format = """
$cmd_duration$time
"""

# --- OS Module ---
[os]
disabled = false
format = "[$symbol]($style) "
style = "bold white"

[os.symbols]
Arch   = ""
Ubuntu = ""
Macos  = ""
Linux  = ""

# --- Directory ---
[directory]
truncation_length = 3
truncation_symbol = ".../"
read_only = " "
style = "bold cyan"

[directory.substitutions]
"~/Documents" = " Documents"
"~/Downloads" = " Downloads"
"~/Pictures"  = " Pictures"
"~/Projects"  = " Projects"
"~/Code"      = " Code"
"~/dotfiles"  = " dotfiles"

# --- Git ---
[git_branch]
symbol = ""
style  = "bold purple"
format = "([$symbol$branch]($style) )"

[git_state]
format = ' [\($state( $progress_current of $progress_total)\)](bold yellow) '

[git_status]
conflicted = " "
ahead = "${count}"
behind = "${count}"
diverged = "${count}"
staged = "+${count}"
modified = "~${count}"
untracked = "?${count}"
stashed = ""
renamed = ""
deleted = "${count}"
style = "bold red"
format = '([$all_status$ahead_behind]($style) )'

# --- Shell indicator ---
# zsh shows nothing (it's the default), other shells show their name
[shell]
disabled = false
format = "[$indicator]($style) "
style = "bold blue"
bash_indicator = "bsh"
zsh_indicator = ""
fish_indicator = "fsh"
nu_indicator = "nu"
unknown_indicator = "?"

# --- Username (shown when not default user or over SSH) ---
[username]
disabled = false
show_always = false
format = "[$user]($style) "
style_user = "bold yellow"
style_root = "bold red"

# --- Hostname (shown over SSH or in containers) ---
[hostname]
disabled = false
ssh_only = true
format = "[@$hostname]($style) "
style = "bold green"

# --- Kubernetes ---
[kubernetes]
disabled = false
format = '[( $context:$namespace)]($style) '
contexts = [
  { context_pattern = ".*prod.*", style = "bold red" },
  { context_pattern = ".*stg.*",  style = "bold yellow" },
  { context_pattern = ".*",       style = "bold blue" }
]
detect_env_vars = []

# --- AWS ---
[aws]
format = '[( $profile)](bold yellow) '
force_display = false

[aws.region_aliases]
us-east-1 = "use1"
us-west-2 = "usw2"
eu-west-1 = "euw1"

# --- Python ---
[python]
format = '[( $virtualenv )(\($version\))]($style) '
style = "bold green"
pyenv_version_name = true
detect_extensions = ["py", "ipynb"]
detect_files = ["pyproject.toml", "requirements.txt", "Pipfile", "poetry.lock"]

# --- Node / JS ---
[nodejs]
format = '[( $version)]($style) '
style = "bold green"
detect_files = ["package.json", "pnpm-lock.yaml", "yarn.lock", "bun.lockb"]

# --- Rust ---
[rust]
format = '[( $version)]($style) '
style = "bold red"

# --- Go ---
[golang]
format = '[( $version)]($style) '
style = "bold cyan"

# --- Docker ---
[docker_context]
format = '[( $context)]($style) '
style = "bold blue"
only_with_files = true
detect_files = ["docker-compose.yml", "docker-compose.yaml", "Dockerfile"]

# --- Terraform ---
[terraform]
format = '[( $workspace)]($style) '
style = "bold magenta"

# --- Package ---
[package]
display_private = true
version_format = "v${raw}"
format = '[( $version)]($style) '
style = "bold blue"

# --- Battery ---
[battery]
disabled = false
format = "[$symbol$percentage]($style) "

[[battery.display]]
threshold = 30
style = "bold red"
charging_symbol = " "
discharging_symbol = " "

[[battery.display]]
threshold = 80
style = "bold yellow"
charging_symbol = " "
discharging_symbol = " "

[[battery.display]]
threshold = 100
style = "bold green"
charging_symbol = " "
discharging_symbol = " "

# --- Command duration ---
[cmd_duration]
min_time = 1500
format = " [ $duration]($style) "
style = "bold green"
show_milliseconds = false

# --- Time ---
[time]
disabled = false
time_format = "%H:%M"
format = " [ $time]($style) "
style = "bold white"

# --- Jobs ---
[jobs]
format = "[$symbol$number]($style) "
style = "bold blue"
symbol = " "
threshold = 1

# --- Prompt character ---
[character]
success_symbol = "[](bold green) "
error_symbol = "[](bold red) "
vicmd_symbol = "[](bold yellow) "

# --- Container ---
[container]
format = '[[ $symbol $name ]]($style) '
style = "bold red dimmed"
symbol = ""

# --- Conda ---
[conda]
format = '[( $environment)]($style) '
style = "bold green"
ignore_base = true

# --- Sudo ---
[sudo]
disabled = false
format = "[ ]($style) "
style = "bold red"
